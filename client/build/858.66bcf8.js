(self.webpackChunkbarbershop=self.webpackChunkbarbershop||[]).push([[858],{30858:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return H}});var n=a(67154),l=a.n(n),r=a(87757),i=a.n(r),m=a(319),u=a.n(m),c=a(48926),s=a.n(c),o=a(63038),d=a.n(o),g=a(67294),f=a(16550),p=a(84751),y=a(62598),_=a(73406),v=(a(21154),[{nameClass:"admin-gallery__button",activeNameClass:"admin-gallery__button--active",nameTxt:"Men"},{nameClass:"admin-gallery__button",activeNameClass:"admin-gallery__button--active",nameTxt:"Women"},{nameClass:"admin-gallery__button",activeNameClass:"admin-gallery__button--active",nameTxt:"Children"},{nameClass:"admin-gallery__button",activeNameClass:"admin-gallery__button--active",nameTxt:"Weddings"},{nameClass:"admin-gallery__button",activeNameClass:"admin-gallery__button--active",nameTxt:"Others"}]),b=a(78310),E=a(60835),I=a(10461),h=a(76213),N=function(){var e=307200,t=["image/png","image/jpeg"],a=h.Ry({title:h.Z_().required("Title is required"),fileImg:h.nK().required("Image is required").test("fileSize","Image is too large, use very small one",(function(t){return t&&t.size<=e})).test("fileFormat","Please use image type png or jpeg",(function(e){return e&&t.includes(e.type)}))});return{FILE_SIZE:e,FILE_FORMATS:t,initialValues:{title:"",fileImg:"",type:""},validationSchema:a}},O=a(22584),S=["image/png","image/jpeg"],w=function(){var e=(0,p.I0)();return{handleFile:function(t,a,n){n("fileImg");var l=(new Date).getTime().toString(),r=t.target.files[0];Object.defineProperty(r,"name",{value:r.name,writable:!0}),r.name="".concat(r.name,"-").concat(l),a("fileImg",r),Boolean(r)&&S.includes(r.type)&&r.size<=307200?e((0,E.Hj)(null,null,r,null,null,null,null)):e((0,E.jF)(null,null,null,null,null,null,null))}}},j=a(27285),F=a(16431),C=a(41691),P=a(73680),k=(a(76031),a(59713)),T=a.n(k),D=(a(18751),function(){var e=307200,t=["image/png","image/jpeg"],a=h.Ry({title:h.Z_().required("Title is required"),fileImg:h.nK().required("Image is required").test("fileSize","Image is too large, use very small one",(function(t){return t&&t.size<=e})).test("fileFormat","Please use image type png or jpeg",(function(e){return e&&t.includes(e.type)}))});return{FILE_SIZE:e,FILE_FORMATS:t,initialValues:{title:"",type:"",fileImg:""},validationSchema:a}}),R=["image/png","image/jpeg"],V=function(){var e=(0,p.I0)();return{handleFileEdit:function(t,a,n){n("fileImg");var l=(new Date).getTime().toString(),r=t.target.files[0];Object.defineProperty(r,"name",{value:r.name,writable:!0}),r.name="".concat(r.name,"-").concat(l),a("fileImg",r),Boolean(r)&&R.includes(r.type)&&r.size<=307200?e((0,E.Hj)(null,null,null,r,null,null,null)):e((0,E.jF)(null,null,null,null,null,null,null))}}},Z=a(72323),x=a(65467);function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){T()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var L=function(e){var t=e.currentImages,a=e.idRow,n=e.imageUrl,l=e.imamgeNewEditLink,r=e.setCurrentImages,m=e.setIsVisiblePanel,u=e.setIsSubmit,c=e.title,o=e.type,f={title:c,type:o,fileImg:""},v=(0,g.useState)(f),b=d()(v,2),E=b[0],I=b[1],h=D(),N=h.initialValues,S=h.validationSchema;(0,O.Z)();var w=V().handleFileEdit,j=(0,Z.Z)().deleteImgFirebase,P=(0,p.I0)(),k=(0,p.v9)((function(e){return e.useAdminData})),T=(0,p.v9)((function(e){return e.alertData})),R=(0,p.v9)((function(e){return e.fileDate})),A=(0,g.useState)(null),L=d()(A,2),U=L[0],M=L[1],q=function(){var e=s()(i().mark((function e(s,d){var g,f,p,y,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return delete s.fileImg,s.imageUrl=l.current,s.id=a,e.next=5,(0,x.zM)(s);case 5:g=e.sent,f=g.data,p=g.status,delete f.imageUpdate.__v,y=f.imageUpdate,200!==p?(P((0,_.PA)(f.alert,"default")),M(null)):(P((0,_.Ob)(f.success,"default")),m(!1),M(null),j(n),u(!0),v=t.map((function(e){return e._id===y._id?B(B({},e),{},{title:y.title,imageUrl:y.imageUrl,type:y.type}):e})),r(v),I({title:c,type:o,fileImg:""})),l.current=null,d.resetForm();case 13:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();(0,g.useEffect)((function(){Boolean(R.fileImageGalleryEdit)&&M(R.fileImageGalleryEdit.name)}),[R]);var G=function(e){var t=e.setFieldValue,a=e.setFieldTouched;return g.createElement("input",{type:"file",onChange:function(e){return w(e,t,a)},className:"admin-gallery__input-file"})},z=function(e){return g.createElement("p",{className:"admin-gallery__error-msg-edit"},e.children)};return g.createElement(y.J9,{enableReinitialize:!0,initialValues:E||N,validationSchema:S,validateOnBlur:!1,onSubmit:q},(function(e){return g.createElement("div",{className:"admin-gallery__edit-form-wrapper"},Boolean(R.fileImageGalleryEdit)&&g.createElement(C.Z,{imamgeNewEditLink:l}),(!Boolean(Object.keys(e.errors).length)&&T.errorServerMsg,g.createElement(F.Z,null)),g.createElement(y.l0,{className:"admin-gallery__form-edit",onSubmit:e.handleSubmit},g.createElement(y.Bc,{name:"fileImg",component:z}),g.createElement("div",{className:"admin-gallery__input-file-add"},g.createElement("label",{className:"admin-gallery__label-file"},"Choose File",g.createElement(y.gN,{as:G,name:"fileImg",type:"file",setFieldValue:e.setFieldValue,setFieldTouched:e.setFieldTouched})),U?g.createElement("span",{className:"admin-gallery__file-name"},U):g.createElement("span",{className:"admin-gallery__file-name"},"No file ...")),g.createElement(y.Bc,{name:"title",component:z}),g.createElement(y.gN,{type:"text",name:"title",className:"admin-gallery__form-input",placeholder:"Title"}),g.createElement("button",{className:"admin-gallery__button-add-image",type:"submit",disabled:!k.enableGallery||!e.isValid},"Edit Image")))}))},U=a(35248),M=a(6841),q=function(e){var t=e._id,a=e.imageUrl,n=e.idImage,l=e.imgUrl,r=e.imamgeNewEditLink,i=e.currentImages,m=e.setCurrentImages,u=e.setImage,c=e.setIsOpenModal,s=e.setIsSubmit,o=e.title,f=e.type,p=(0,g.useState)(""),y=d()(p,2),_=y[0],v=y[1],b=(0,g.useState)(!1),E=d()(b,2),I=E[0],h=E[1],N=(0,U.Z)(a);return g.createElement("div",{className:"admin-gallery__row"},g.createElement("div",{className:"admin-gallery__row-image"},g.createElement("div",{className:"admin-gallery__image-frame",style:{backgroundImage:"url(".concat(a,")")}},!N&&g.createElement("div",{className:"admin-gallery__overlay"},g.createElement(M.Z,null))),g.createElement("div",{className:"admin-gallery__buttons-wrapper"},g.createElement("button",{className:I?"admin-gallery__edit admin-gallery__edit--active":"admin-gallery__edit",onClick:function(){h((function(e){return!e})),u(""),v(t)}},g.createElement("i",{className:"far fa-edit"})),g.createElement("button",{className:n===_&&n&&""!==_?"admin-gallery__delete admin-gallery__delete--active":"admin-gallery__delete",onClick:function(){v(t),u(t),l.current=a,c(!0),h(!1)}},g.createElement("i",{className:"far fa-trash-alt"})))),g.createElement("div",{className:I?"admin-gallery__panel-edit admin-gallery__panel-edit--active":"admin-gallery__panel-edit"},g.createElement(L,{currentImages:i,setCurrentImages:m,setIsVisiblePanel:h,setIsSubmit:s,idRow:_,imageUrl:a,title:o,type:f,imamgeNewEditLink:r})))};function G(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var z=function(e,t,a,n,l){var r=(0,Z.Z)().deleteImgFirebase,m=(0,p.I0)(),c=function(){var t=[];return e.forEach((function(e){var a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?G(Object(a),!0).forEach((function(t){T()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):G(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e);t=[].concat(u()(t),[a])})),t};return{handleRemoveItem:function(){var e=s()(i().mark((function e(){var u,s,o,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.EH)(t);case 2:u=e.sent,s=u.data,200===u.status?(r(a.current),m((0,_.Ob)(s.success,"removeAtTableAdmin")),o=c(),d=o.filter((function(e){return e._id!==t})),n(d),l(!1)):m((0,_.PA)(s.alert,"removeAtTableAdmin"));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}},H=function(){var e=N(),t=e.initialValues,a=e.validationSchema;(0,O.Z)();var n=w().handleFile,r=(0,p.I0)(),m=(0,p.v9)((function(e){return e.useAdminData})),c=(0,p.v9)((function(e){return e.alertData})),o=(0,p.v9)((function(e){return e.fileDate})),h=(0,p.v9)((function(e){return e.galleryImgData})).images,S=(0,g.useState)("men"),k=d()(S,2),T=k[0],D=k[1],R=(0,g.useState)([]),V=d()(R,2),Z=V[0],A=V[1],B=(0,g.useState)(""),L=d()(B,1)[0],U=(0,g.useState)(""),M=d()(U,2),G=M[0],H=M[1],J=(0,g.useState)(0),K=d()(J,2),W=K[0],Q=K[1],X=(0,g.useState)(!1),Y=d()(X,2),$=Y[0],ee=Y[1],te=(0,g.useState)(null),ae=d()(te,2),ne=ae[0],le=ae[1],re=(0,g.useState)(!1),ie=d()(re,2),me=ie[0],ue=ie[1],ce=(0,g.useRef)(null),se=(0,g.useRef)(null),oe=(0,g.useRef)(null),de=(0,g.useRef)(null),ge=(0,f.k6)();(0,j.Z)(se);var fe=z(Z,G,ce,A,ee).handleRemoveItem,pe=function(){var e=s()(i().mark((function e(t,a){var n,l,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return delete t.fileImg,t.imageUrl=se.current,t.type=T,e.next=5,(0,x.je)(t);case 5:n=e.sent,l=n.data,m=n.status,delete l.image.__v,200!==m?(r((0,_.PA)(l.alert,"default")),le(null),D(null)):(r((0,_.Ob)(l.success,"default")),le(null),A([].concat(u()(Z),[l.image]))),se.current=null,a.resetForm();case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ye=function(){ee(!1),H("")};(0,g.useEffect)((function(){Boolean(o.fileImageGallery)&&le(o.fileImageGallery.name)}),[o]),(0,g.useEffect)((function(){r((0,b.Iq)(T))}),[T,r]),(0,g.useEffect)((function(){de.current&&A(h)}),[h]),(0,g.useEffect)((function(){return de.current=!0,function(){return de.current=!1}}),[]),(0,g.useEffect)((function(){ge.listen((function(){if("/admin/gallery"!==ge.location.pathname&&oe.current&&-1!==oe.current.indexOf("firebasestorage")){var e=I.v.refFromURL(oe.current);oe.current=null,r((0,E.jF)(null,null,null,null,null,null)),e.delete().then((function(e){return e})).catch((function(e){L(e)}))}}))}),[me,oe.current]);var _e=function(e){var t=e.setFieldValue,a=e.setFieldTouched;return g.createElement("input",{type:"file",onChange:function(e){return n(e,t,a)},className:"admin-gallery__input-file"})},ve=function(e){return g.createElement("p",{className:"admin-gallery__error-msg"},e.children)};return g.createElement(y.J9,{initialValues:t,validationSchema:a,onSubmit:pe},(function(e){return g.createElement("article",{className:"admin-gallery"},g.createElement("div",{className:"admin-gallery__wrapper"},g.createElement("div",{className:"admin-gallery__wrapper-buttons"},v.map((function(e,t){return g.createElement("button",{className:W===t?"".concat(e.activeNameClass," ").concat(e.nameClass):e.nameClass,key:t,onClick:function(e){return function(e,t){Q(t);var a=e.target.innerHTML;D(a.toLowerCase())}(e,t)}},e.nameTxt)}))),Boolean(o.fileImageGallery)&&g.createElement(C.Z,{imgLink:se}),(!Boolean(Object.keys(e.errors).length)&&c.errorServerMsg,g.createElement(F.Z,null)),Z.length<6&&g.createElement(y.l0,{className:"admin-gallery__wrapper-form-add",onSubmit:e.handleSubmit},g.createElement(y.Bc,{name:"fileImg",component:ve}),g.createElement("div",{className:"admin-gallery__input-file-add"},g.createElement("label",{className:"admin-gallery__label-file"},"Choose File",g.createElement(y.gN,{as:_e,name:"fileImg",type:"file",setFieldValue:e.setFieldValue,setFieldTouched:e.setFieldTouched})),ne?g.createElement("span",{className:"admin-gallery__file-name"},ne):g.createElement("span",{className:"admin-gallery__file-name"},"No file ...")),g.createElement(y.Bc,{name:"title",component:ve}),g.createElement(y.gN,{type:"text",name:"title",className:"admin-gallery__form-input",placeholder:"Title"}),g.createElement("button",{className:"admin-gallery__button-add-image",type:"submit",disabled:!m.enableGallery||!e.isValid},"Add Image")),g.createElement("div",{className:"admin-gallery__header"},g.createElement("p",{className:"admin-gallery__number"},"Total number: ",Z.length),g.createElement("p",{className:"admin-gallery__action"},"Action")),g.createElement("div",{className:"admin-gallery__wrapper-images"},Z.map((function(e,t){return g.createElement(q,l()({key:e._id},e,{setImage:H,idImage:G,imgUrl:ce,setIsOpenModal:ee,currentImages:Z,setCurrentImages:A,setIsSubmit:ue,imamgeNewEditLink:oe}))})))),g.createElement(P.Z,{enableAction:m.enableGallery,isOpenModal:$,handleRemoveItem:fe,handleNotRemoveItem:ye,purpose:"image"}))}))}},21154:function(){},18751:function(){},76031:function(){}}]);